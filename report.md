#  工业级智能医疗导诊系统：基于多源知识库与决策引擎的AI实现 |
## 一、项目背景 

随着“慧心健康”AI导诊项目的推进，初代系统已能处理两步查询。然而，在真实临床场景中，决策往往需要综合更多维度的信息。例如，除了症状和处理指南，还需要考虑**疾病的特定人群风险**（如儿童、老人）或**特殊说明**。为此，公司决定将内部的第三个知识库——**“疾病百科与风险提示库”**也接入系统。 	

本次项目升级的目标，是构建一个能够协同调用**三个独立知识库**、进行复杂信息综合与安全决策的工业级AI系统，使其导诊建议的准确性和安全性再上一个新台阶。 

## 二、项目目标 

作为项目的核心工程师，你需要基于**ReAct（推理-行动）思想**，将系统升级为一个能够与三个外部工具交互的、决策逻辑更完备的智能系统。 

1. **复杂任务规划**：面对用户输入，能够推理出调用三个工具的**动态、有序**的行动计划。 
2. **精确工具调用**：能够精确、高效地调用所有工具，并正确处理各种返回情况（如成功、失败、部分成功）。 
3. **三方信息综合与决策**：根据实际问题能够将来自三个不同知识库的信息（潜在病症、处理指南、风险提示）进行**交叉验证和融合**，形成一个逻辑严密、信息完整的最终决策。 
4. **高质量与安全响应**：生成包含所有关键信息的结构化JSON回复，并坚守最严格的安全与伦理红线。 

## 三、核心数据源



## 四、项目实现要求 

==**tips: 可以借助任何你可以借助的AI工具！项目的中级目标：鲁棒性、智能性、可用性**== 

1. **核心Prompt**：构建`Prompt`，使其能够理解并编排三个工具。 
2. **工业级代码结构**：推荐采用**面向对象**的方式进行编程，例如创建一个`MedicalSystem`类来封装所有后端逻辑（工具定义、Prompt管理、ReAct循环等），使得代码结构清晰、易于维护。 
3. **系统能力要求**：最终系统必须能够处理**“症状->多种可能病症->锁定最高风险病症->查询处理指南->查询风险提示->综合所有信息->生成最终答案”**的完整、复杂逻辑链。 

## 评估测试用例



## 实现细节

技术栈：
- **后端框架**：Flask（Python）,langchain
- **前端框架**：streamlit（Python）
- **数据库**：PostgreSQL, 第一版本使用data目录中的json，第二版本使用PostgreSQL存储疾病百科与风险提示库。
- **向量数据**：PostgreSQL， 第一版本使用json存储疾病百科的向量表示，第二版本使用向量数据库（如PostgreSQL）存储风险提示库的向量表示。
- **AI模型**：deepseek 使用环境变量配置url,key
- **其他工具**：Docker、Nginx （第一版本不使用，第二版本使用）
- **日志记录**：使用Python的logging模块，配置为INFO级别，记录关键操作和异常信息。
- **安全**： 防止输入框注入提示词攻击，意图识别之后，返回兜底提示。

业务逻辑：
1. 用户输入症状描述。
2. 系统先识别语义， 是否有侵入，攻击，更改系统提示词风险，角色更改，恶意攻击的意思， 如果识别到，返回True/False，通过判断结果。如果为False，则直接返回友好内容回复即可：“您的输入似乎包含了一些风险操作，请重新描述有效症状。”
3. 如果语义识别为正常查询（True）， 则继续下一步。
4. 根据用户输入的症状描述，查询与data\symptom.json的哪几个症状相似，查询可能的疾病，并返回对应的list = symptom_ids
  - 如果查询到多个相似症状，则返回所有可能的疾病。
  - 如果查询到没有相似症状，则返回提示用户重新描述症状。
5. 返回用户疑似疾病的症状name，description。 然后询问用户年龄，性别或者特殊说明。
6. 根据用户回答，获取用户年龄，性别，特殊说明。 结合symptom_id，查询对应知识库：
   - 疾病百科：根据symptom_id查询data\guideline.json疾病的处理指南。
   - 风险提示库：根据symptom_id查询data\disease_info.json疾病的风险提示。
   - 如果获取成功之后，则根据用户年龄，性别，特殊说明，结合疾病百科和风险提示，生成最终的决策建议。

目录结构：












3. 系统调用风险提示库，根据用户年龄、性别等信息查询风险提示。
4. 系统综合疾病百科和风险提示，生成最终的决策建议。